<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ManifestHub æ¸…å•è°ƒç”¨åŠ©æ‰‹</title>
  <style>
    :root {
      color-scheme: dark;
      --bg: #0f172a;
      --panel: #111827;
      --accent: #38bdf8;
      --accent-strong: #0ea5e9;
      --muted: #9ca3af;
      --error: #f87171;
      --success: #4ade80;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      background: radial-gradient(circle at 20% 20%, rgba(56, 189, 248, 0.12), transparent 25%),
        radial-gradient(circle at 80% 0%, rgba(14, 165, 233, 0.14), transparent 22%),
        var(--bg);
      min-height: 100vh;
      color: #e5e7eb;
    }

    header {
      padding: 32px 20px 12px;
      max-width: 960px;
      margin: 0 auto;
    }

    h1 {
      margin: 0 0 8px;
      font-size: clamp(28px, 4vw, 34px);
      color: #f8fafc;
      letter-spacing: -0.02em;
    }

    p.lead {
      margin: 0;
      color: var(--muted);
      max-width: 720px;
      line-height: 1.6;
    }

    main {
      max-width: 960px;
      margin: 0 auto 48px;
      padding: 0 20px 40px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 18px;
    }

    .card {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0));
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      border-radius: 16px;
      padding: 18px;
      backdrop-filter: blur(8px);
    }

    .card h2 {
      margin: 0 0 10px;
      font-size: 18px;
      letter-spacing: -0.01em;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    label {
      color: var(--muted);
      font-size: 13px;
    }

    input, textarea {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 10px;
      color: #f1f5f9;
      padding: 12px;
      font-size: 15px;
      transition: border-color 0.15s ease, box-shadow 0.15s ease;
    }

    input:focus, textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.18);
    }

    button {
      border: none;
      border-radius: 10px;
      padding: 12px 16px;
      background: linear-gradient(120deg, var(--accent-strong), #22d3ee);
      color: #0b1224;
      font-weight: 700;
      font-size: 15px;
      cursor: pointer;
      transition: transform 0.12s ease, filter 0.12s ease, box-shadow 0.12s ease;
      box-shadow: 0 12px 30px rgba(14, 165, 233, 0.35);
    }

    button:hover {
      transform: translateY(-1px);
      filter: brightness(1.05);
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .toolbar {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .pill {
      display: inline-flex;
      gap: 8px;
      align-items: center;
      font-size: 13px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.06);
      color: var(--muted);
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .status {
      font-size: 14px;
      color: var(--muted);
      min-height: 20px;
    }

    pre {
      margin: 0;
      background: #0b1224;
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 12px;
      padding: 14px;
      overflow-x: auto;
      font-size: 13px;
      line-height: 1.5;
      white-space: pre-wrap;
      word-break: break-word;
    }

    code {
      font-family: "SFMono-Regular", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .result-title {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 12px;
      flex-wrap: wrap;
    }

    .url-preview {
      background: rgba(255, 255, 255, 0.04);
      border: 1px dashed rgba(255, 255, 255, 0.08);
      padding: 10px 12px;
      border-radius: 10px;
      color: var(--muted);
      font-size: 13px;
      word-break: break-all;
    }

    .tips {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px;
    }

    .tip {
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(255, 255, 255, 0.05);
      padding: 12px;
      border-radius: 12px;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.5;
    }

    .tip strong {
      color: #e5e7eb;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 8px;
      background: rgba(74, 222, 128, 0.12);
      color: #bbf7d0;
      border: 1px solid rgba(74, 222, 128, 0.3);
    }

    @media (min-width: 800px) {
      .grid.two-columns {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Steam æ¸…å•è°ƒç”¨åŠ©æ‰‹</h1>
    <p class="lead">åŸºäº ManifestHub API çš„å¿«é€Ÿè°ƒç”¨é¡µé¢ï¼Œè¾“å…¥ API Keyã€Depot ID ä¸ Manifest IDï¼Œå³å¯ç›´æ¥è·å–æ¸…å•æ•°æ®ã€‚æ— éœ€é¢å¤–ä¾èµ–ï¼Œæ–‡ä»¶å¯ç¦»çº¿ä¿å­˜ã€‚</p>
  </header>

  <main>
    <section class="card">
      <h2>è¾“å…¥å‚æ•°</h2>
      <form id="manifest-form" class="grid two-columns" autocomplete="on">
        <div class="field">
          <label for="apiKey">API Key</label>
          <input id="apiKey" name="apiKey" placeholder="å¿…å¡«ï¼Œ24 å°æ—¶æœ‰æ•ˆçš„ API Key" required />
        </div>
        <div class="field">
          <label for="depotId">Depot ID</label>
          <input id="depotId" name="depotId" inputmode="numeric" pattern="\\d*" placeholder="ä¾‹å¦‚ï¼š228980" required />
        </div>
        <div class="field">
          <label for="manifestId">Manifest ID</label>
          <input id="manifestId" name="manifestId" inputmode="numeric" pattern="\\d*" placeholder="éœ€è¦è°ƒç”¨çš„ manifest id" required />
        </div>
        <div class="field">
          <label for="note">å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰</label>
          <input id="note" name="note" placeholder="ç»™è‡ªå·±æˆ–å›¢é˜Ÿçš„æ ‡è®°ï¼Œä¸ä¼šå‚ä¸è¯·æ±‚" />
        </div>
        <div class="toolbar" style="grid-column: 1 / -1;">
          <button type="submit" id="submitBtn">è°ƒç”¨æ¸…å•</button>
          <button type="button" id="copyUrlBtn" class="pill" title="å¤åˆ¶å®Œæ•´ API è¯·æ±‚ URL">
            ğŸ“‹ å¤åˆ¶è°ƒç”¨é“¾æ¥
          </button>
          <span class="pill">
            ğŸ”’ å¯†é’¥ä»…ä¿å­˜åœ¨æœ¬åœ°æµè§ˆå™¨ï¼Œä¸ä¼šå‘é€åˆ°ç¬¬ä¸‰æ–¹ç«™ç‚¹
          </span>
        </div>
        <div class="status" id="status" style="grid-column: 1 / -1;"></div>
      </form>
      <div class="url-preview" id="urlPreview">ç­‰å¾…è¾“å…¥å‚æ•°åå°†è‡ªåŠ¨ç”Ÿæˆè°ƒç”¨é“¾æ¥ã€‚</div>
    </section>

    <section class="card">
      <div class="result-title">
        <h2>è¿”å›ç»“æœ</h2>
        <span class="badge" id="badge">å°±ç»ª</span>
      </div>
      <pre id="result"><code>å°šæœªå‘é€è¯·æ±‚ã€‚å¡«å†™å‚æ•°å¹¶ç‚¹å‡»ã€Œè°ƒç”¨æ¸…å•ã€å³å¯æŸ¥çœ‹å“åº”å†…å®¹ã€‚</code></pre>
    </section>

    <section class="card">
      <h2>ä½¿ç”¨æç¤º</h2>
      <div class="tips">
        <div class="tip"><strong>æ¥å£åœ°å€ï¼š</strong> https://api.manifesthub1.filegear-sg.me/manifest</div>
        <div class="tip"><strong>å‚æ•°ï¼š</strong>apikeyï¼ˆå¿…å¡«ï¼‰ã€depotidï¼ˆå¿…å¡«ï¼‰ã€manifestidï¼ˆå¿…å¡«ï¼‰</div>
        <div class="tip"><strong>æœ‰æ•ˆæœŸï¼š</strong> å…è´¹ API Key æœ‰æ•ˆæœŸ 24 å°æ—¶ï¼Œåˆ°æœŸåéœ€é‡æ–°ç”³è¯·</div>
        <div class="tip"><strong>è¿”å›æ ¼å¼ï¼š</strong> æ”¯æŒ JSON è¿”å›ï¼Œå¯ç›´æ¥ä¿å­˜è¾“å‡ºä¸­çš„ manifest é“¾æ¥ä¸å­—æ®µ</div>
      </div>
    </section>
  </main>

  <script>
    const form = document.getElementById('manifest-form');
    const statusEl = document.getElementById('status');
    const resultEl = document.getElementById('result');
    const badgeEl = document.getElementById('badge');
    const urlPreviewEl = document.getElementById('urlPreview');
    const copyUrlBtn = document.getElementById('copyUrlBtn');
    const submitBtn = document.getElementById('submitBtn');

    const baseUrl = 'https://api.manifesthub1.filegear-sg.me/manifest';

    function setBadge(text, tone) {
      const colors = {
        idle: { bg: 'rgba(74, 222, 128, 0.12)', border: 'rgba(74, 222, 128, 0.3)', color: '#bbf7d0' },
        progress: { bg: 'rgba(56, 189, 248, 0.16)', border: 'rgba(56, 189, 248, 0.35)', color: '#bae6fd' },
        error: { bg: 'rgba(248, 113, 113, 0.14)', border: 'rgba(248, 113, 113, 0.4)', color: '#fecdd3' }
      };
      const theme = colors[tone] || colors.idle;
      badgeEl.textContent = text;
      badgeEl.style.background = theme.bg;
      badgeEl.style.borderColor = theme.border;
      badgeEl.style.color = theme.color;
    }

    function buildUrl(apiKey, depotId, manifestId) {
      const params = new URLSearchParams({ apikey: apiKey, depotid: depotId, manifestid: manifestId });
      return `${baseUrl}?${params.toString()}`;
    }

    function renderUrlPreview(apiKey, depotId, manifestId) {
      if (!apiKey || !depotId || !manifestId) {
        urlPreviewEl.textContent = 'ç­‰å¾…è¾“å…¥å‚æ•°åå°†è‡ªåŠ¨ç”Ÿæˆè°ƒç”¨é“¾æ¥ã€‚';
        return null;
      }
      const maskedKey = apiKey.length > 6 ? `${apiKey.slice(0, 3)}â€¦${apiKey.slice(-3)}` : apiKey;
      const url = buildUrl(apiKey, depotId, manifestId).replace(apiKey, maskedKey);
      urlPreviewEl.textContent = url;
      return url;
    }

    function formatJson(text) {
      try {
        const obj = JSON.parse(text);
        return JSON.stringify(obj, null, 2);
      } catch (err) {
        return text || 'å“åº”ä¸ºç©º';
      }
    }

    function setStatus(message, tone = 'muted') {
      statusEl.textContent = message;
      if (tone === 'error') {
        statusEl.style.color = 'var(--error)';
      } else if (tone === 'success') {
        statusEl.style.color = 'var(--success)';
      } else {
        statusEl.style.color = 'var(--muted)';
      }
    }

    function setResult(text) {
      resultEl.textContent = text;
    }

    copyUrlBtn.addEventListener('click', async () => {
      const apiKey = form.apiKey.value.trim();
      const depotId = form.depotId.value.trim();
      const manifestId = form.manifestId.value.trim();
      const url = buildUrl(apiKey, depotId, manifestId);
      if (!apiKey || !depotId || !manifestId) {
        setStatus('è¯·è¾“å…¥ API Keyã€Depot ID ä¸ Manifest ID åå†å¤åˆ¶ã€‚', 'error');
        setBadge('ç¼ºå°‘å‚æ•°', 'error');
        return;
      }
      try {
        await navigator.clipboard.writeText(url);
        setStatus('å·²å¤åˆ¶å®Œæ•´è¯·æ±‚é“¾æ¥ï¼Œå¯ç›´æ¥åˆ†äº«ç»™éœ€è¦è°ƒè¯•çš„åŒäº‹ã€‚', 'success');
        setBadge('å·²å¤åˆ¶', 'idle');
      } catch (err) {
        setStatus('æ— æ³•å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶æ˜¾ç¤ºçš„é“¾æ¥ã€‚', 'error');
        setBadge('å¤åˆ¶å¤±è´¥', 'error');
      }
    });

    ['apiKey', 'depotId', 'manifestId'].forEach((name) => {
      form[name].addEventListener('input', () => {
        renderUrlPreview(form.apiKey.value.trim(), form.depotId.value.trim(), form.manifestId.value.trim());
      });
    });

    form.addEventListener('submit', async (event) => {
      event.preventDefault();
      const apiKey = form.apiKey.value.trim();
      const depotId = form.depotId.value.trim();
      const manifestId = form.manifestId.value.trim();

      const requestUrl = buildUrl(apiKey, depotId, manifestId);
      renderUrlPreview(apiKey, depotId, manifestId);

      submitBtn.disabled = true;
      setBadge('è¯·æ±‚ä¸­â€¦', 'progress');
      setStatus('æ­£åœ¨è¯·æ±‚ ManifestHub APIï¼Œè¯·ç¨å€™â€¦');
      setResult('');

      try {
        const response = await fetch(requestUrl, { headers: { Accept: 'application/json' } });
        const text = await response.text();
        const formatted = formatJson(text);

        if (!response.ok) {
          setStatus(`è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç  ${response.status}ã€‚`, 'error');
          setBadge('è¯·æ±‚å¤±è´¥', 'error');
        } else {
          setStatus('è¯·æ±‚æˆåŠŸï¼Œå¯åœ¨ä¸‹æ–¹æŸ¥çœ‹å®Œæ•´å“åº”ã€‚', 'success');
          setBadge('è¯·æ±‚æˆåŠŸ', 'idle');
        }
        setResult(formatted);
      } catch (error) {
        console.error(error);
        setStatus('ç½‘ç»œå¼‚å¸¸æˆ–æµè§ˆå™¨é˜»æ­¢äº†è¯·æ±‚ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°ã€‚', 'error');
        setResult(error.message || 'è¯·æ±‚æœªå®Œæˆã€‚');
        setBadge('ç½‘ç»œé”™è¯¯', 'error');
      } finally {
        submitBtn.disabled = false;
      }
    });

    setResult('å°šæœªå‘é€è¯·æ±‚ã€‚å¡«å†™å‚æ•°å¹¶ç‚¹å‡»ã€Œè°ƒç”¨æ¸…å•ã€å³å¯æŸ¥çœ‹å“åº”å†…å®¹ã€‚');
    renderUrlPreview('', '', '');
  </script>
</body>
</html>
